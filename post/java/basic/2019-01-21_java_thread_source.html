<!DOCTYPE html>
<html lang="zh-CN">

<!-- Head tag -->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="referrer" content="no-referrer-when-downgrade">
  
  <meta name="baidu-site-verification" content="" />
  <meta name="google-site-verification" content="" />
  <meta name="msvalidate.01" content="" />
  <meta name="360-site-verification" content="" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- if page has tags, then add tags to keyword -->
  
  
  <meta name="keywords" content=",Java,Java线程,源码,">
  <!-- page.description has higher priority -->
  <meta name="description" content="Share everything">
  <link rel="shortcut icon" href="/favico.png">
  <title>
    
    从源码的角度再学「Thread」 | 分享之
    
  </title>

  <link rel="canonical" href="/post/java/basic/2019-01-21_java_thread_source.html">
  
<link rel="stylesheet" href="/css/reset.css">

  
<link rel="stylesheet" href="/css/layout.css">

  
<link rel="stylesheet" href="/css/markdown.css">

  <!-- Pygments Highlight CSS -->
  
<link rel="stylesheet" href="/css/highlight.css">

  
<link rel="stylesheet" href="/css/geektutu.css">

  <!-- global function -->
  <script>
    window.globalAddScript = function (url, onload, onerror) {
      var s = document.createElement('script');
      s.src = url;
      onload && (s.onload = onload);
      onerror && (s.onerror = onerror);
      document.body.appendChild(s);
    }
    window.globalAddCss = function (url) {
      var s = document.createElement('link');
      s.rel = 'stylesheet';
      s.href = url;
      document.body.appendChild(s);
    }
    window.getPosition = function (ele) {
      var x = 0, y = 0;
      while (ele) {
        x += (ele.offsetLeft - ele.scrollLeft + ele.clientLeft);
        y += (ele.offsetTop - ele.scrollTop + ele.clientTop);
        ele = ele.offsetParent;
      }
      return { x: x, y: y };
    }
    window.getDom = function (str) { return document.querySelector(str) }
  </script>
  <!-- google ad -->
  
<meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/feed.xml" title="分享之" type="application/rss+xml">
</head>

<body>
    <header class="gkt-header col-xs-12 padding-0">
    <div id="gkt-nav" class="gkt-header-container">
        <a href="/" class="gkt-header-title float-left">
            <img class="float-left" src="/favico.png" alt="">
            <span>分享之</span>
        </a>
        <nav class="gkt-header-nav text-right">
            <ul>
                <li><a class="hidden-xs" href="/feed.xml">订阅</a></li>
                <li><a href="/series/">专题</a></li>
                <li><a href="/archives/">归档</a></li>
                <li><a href="/post/link.html">友链</a></li>
                <li><a href="/post/about.html">关于</a></li>
            </ul>
        </nav>
    </div>
    <div id="gkt-cate-nav" class="gkt-header-container hidden-xs">
        
        <nav class="gkt-header-nav float-left">
            <ul>
                
                
                <li class="gkt-cate-name float-left active">
                    <a class="float-left" href="/post/java/basic/2016-10-25_hashmap_jdk7.html">Java ▾</a>
                    
                    <ul class="gkt-sub-cate">
                        
                        <li class="gkt-sub-cate-name active"><a class="float-left"
                                href="/post/java/basic/2016-10-25_hashmap_jdk7.html">Java 基础</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/java/advance/2016-10-25_number.html">Java 进阶</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/java/io/2017-04-15_java_io_1_overview.html">Java IO</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/java/nio/2017-04-21_java_nio_1.html">Java NIO</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/interview/2018-10-25_Java面试整理.html">Java 面试</a></li>
                        
                    </ul>
                    
                </li>
                
                <li class="gkt-cate-name float-left ">
                    <a class="float-left" href="/post/java/spring/2016-10-30_Spring 组合注解&amp;注解继承.html">Spring ▾</a>
                    
                    <ul class="gkt-sub-cate">
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/java/spring/2016-10-30_Spring 组合注解&amp;注解继承.html">Spring Core</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/java/spring/2019-12-28_【译】Spring Boot 从 classpath 加载文件.html">Spring Boot</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/java/spring/2020-09-02_How-to-learn-Spring-Cloud.html">Spring Cloud</a></li>
                        
                    </ul>
                    
                </li>
                
                <li class="gkt-cate-name float-left ">
                    <a class="float-left" href="/post/java/netty/2019-01-02_小白科普Netty有什么用.html">Java 框架</a>
                    
                </li>
                
                <li class="gkt-cate-name float-left ">
                    <a class="float-left" href="/post/util/ide/2017-10-25_idea_shotcut.html">工具 ▾</a>
                    
                    <ul class="gkt-sub-cate">
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/util/ide/2017-10-25_idea_shotcut.html">IDE</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/util/gradle/LearnGradle_1_安装.html">Gradle</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/docker/2017-11-25_Docker_Get_Started.html">Docker</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/util/monitor/2017-12-10_从零开始搭建Prometheus自动监控报警系统.html">监控</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/util/svn/2017-12-10_SVN自动删除“被手动删除”的文件.html">SVN</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/util/2020-11-26_开发资源整理.html">资源导航</a></li>
                        
                    </ul>
                    
                </li>
                
                <li class="gkt-cate-name float-left ">
                    <a class="float-left" href="/post/linux/2017-11-27_update-alternatives_命令.html">Linux ▾</a>
                    
                    <ul class="gkt-sub-cate">
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/linux/2017-11-27_update-alternatives_命令.html">其他</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/linux/2017-11-26_IO-同步，异步，阻塞，非阻塞.html">IO</a></li>
                        
                    </ul>
                    
                </li>
                
                <li class="gkt-cate-name float-left ">
                    <a class="float-left" href="/post/network/2017-11-24_面向报文（UDP）和面向字节流（TCP）的区别.html">计算机网络 ▾</a>
                    
                    <ul class="gkt-sub-cate">
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/network/2017-11-24_面向报文（UDP）和面向字节流（TCP）的区别.html">TCP/IP</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/network/2017-11-25_一张图说明CDN网络的原理.html">网络/其他</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/network/2018-12-15_URL和URI的区别.html">网络/术语</a></li>
                        
                    </ul>
                    
                </li>
                
                <li class="gkt-cate-name float-left ">
                    <a class="float-left" href="/post/dateabase/mysql/2018-12-15_MySQL优化概要.html">数据库 ▾</a>
                    
                    <ul class="gkt-sub-cate">
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/dateabase/mysql/2018-12-15_MySQL优化概要.html">MySQL</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/dateabase/MSSQL/2020-09-08_MSSQL最佳实践_SQL_Server备份策略.html">MSSQL</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/dateabase/Redis/2020_12_08_Redis清理方法.html">Redis</a></li>
                        
                    </ul>
                    
                </li>
                
                <li class="gkt-cate-name float-left ">
                    <a class="float-left" href="/post/design/2019-01-03_Java经典设计模式_1_五大创建型模式.html">设计模式</a>
                    
                </li>
                
                <li class="gkt-cate-name float-left ">
                    <a class="float-left" href="/post/distribution/2019-08-12_CAP定理的含义.html">分布式 ▾</a>
                    
                    <ul class="gkt-sub-cate">
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/distribution/2019-08-12_CAP定理的含义.html">概念</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/distribution/2019-08-13_Zookeeper是如何解决脑裂问题.html">zookeeper</a></li>
                        
                    </ul>
                    
                </li>
                
                <li class="gkt-cate-name float-left ">
                    <a class="float-left" href="/post/frontend/vue/2017-10-26_vue自定义组件中的v-model简单解释.html">前端 ▾</a>
                    
                    <ul class="gkt-sub-cate">
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/frontend/vue/2017-10-26_vue自定义组件中的v-model简单解释.html">VUE</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/frontend/2016-10-26_深入理解jQuery插件开发.html">jQuery</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/frontend/2019-10-26_小程序多端框架全面测评.html">跨平台</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/frontend/2019-11-26_APK反编译总结.html">Android</a></li>
                        
                    </ul>
                    
                </li>
                
                <li class="gkt-cate-name float-left ">
                    <a class="float-left" href="/post/algorithm/八皇后算法解析.html">算法</a>
                    
                </li>
                
                <li class="gkt-cate-name float-left ">
                    <a class="float-left" href="/post/其他/2020-01-29_弹琴吧非会员扒谱技巧.html">其他 ▾</a>
                    
                    <ul class="gkt-sub-cate">
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/其他/2020-01-29_弹琴吧非会员扒谱技巧.html">其他/Tampermonkey</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/其他/2020-10-25_V2ray配置.html">其他/V2ray</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/其他/2020-11-26_Jira修改Path路径后的用户管理问题.html">其他/Jira</a></li>
                        
                        <li class="gkt-sub-cate-name "><a class="float-left"
                                href="/post/其他/2020-11-27_『认知升级』是比其他一切都更加重要的思维模型转变.html">其他/管理</a></li>
                        
                    </ul>
                    
                </li>
                
            </ul>
        </nav>
    </div>
</header>
<div class="gkt-header-placeholder" style="height: 44px"></div>
<div class="gkt-header-placeholder hidden-xs" style="height: 44px"></div>
<script>
    (function () {
        window.addEventListener('scroll', function () {
            if (window.innerWidth < 768) {
                return;
            }
            var nav = document.querySelector('#gkt-nav');
            var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
            scrollTop > 50 && (nav.classList.add('hide'));
            scrollTop <= 50 && (nav.classList.remove('hide'));
        });
        var cateNavs = document.querySelectorAll('#gkt-cate-nav>nav>ul>li');
        [].slice.call(cateNavs).forEach(function (item) {
            var sub = item.querySelector('.gkt-sub-cate');
            if (!sub) return;
            item.addEventListener('mouseenter', function (e) { sub.style.display = 'block'; }, false);
            item.addEventListener('mouseleave', function (e) { sub.style.display = 'none'; }, false);
        })
    })();
</script>
    <!-- Main Content -->
    <div class="main-container">
        <!-- Main Content -->
<main class="col-xs-12 padding-0 markdown-it">
    <!-- Post Container -->
    
    
    <!-- Post Content -->
<div class="float-left post-container box-shadow">
    <div class="u-arrow-wrapper hidden-xs">
        
        <a class="float-left" href="/post/design/2019-01-05_Java经典设计模式_3_十一种行为型模式.html"><i class="u-arrow-left"></i></a>
        
        
        <a class="float-right" href="/post/java/nio/2019-02-27_java_nio_model.html"><i class="u-arrow-right"></i></a>
        
    </div>
    <article class="col-xs-12">
        <h1> 从源码的角度再学「Thread」 </h1>
        
        
        <div class="hidden-lg hidden-md series_links">
            <p> <strong> Java 基础系列文章链接：</strong></p>
            <ul>
                
                <li>
                    <a href="/post/java/basic/2016-10-25_hashmap_jdk7.html">关于 HashMap （JDK 1.7）</a>
                    <span class="post-item-date">(Oct 24, 2016)</span>
                </li>
                
                <li>
                    <a href="/post/java/basic/2016-10-25_threadlocal.html">ThreadLocal 笔记</a>
                    <span class="post-item-date">(Oct 25, 2016)</span>
                </li>
                
                <li>
                    <a href="/post/java/basic/2016-11-18_try_with_resources.html">Java7 里 try-with-resources 分析</a>
                    <span class="post-item-date">(Nov 27, 2016)</span>
                </li>
                
                <li>
                    <a href="/post/java/basic/2017-04-18_java_thread_mind.html">Java Thread 线程知识整理（思维导图）</a>
                    <span class="post-item-date">(Apr 18, 2017)</span>
                </li>
                
                <li>
                    <a href="/post/java/basic/2017-07-14_java_reference.html">Java 引用</a>
                    <span class="post-item-date">(Jul 14, 2017)</span>
                </li>
                
                <li>
                    <a href="/post/java/basic/2017-11-10_java-lambda.html">Java8 lambda表达式10个示例</a>
                    <span class="post-item-date">(Nov 10, 2017)</span>
                </li>
                
                <li>
                    <a href="/post/java/basic/2019-01-21_java_thread_source.html">从源码的角度再学「Thread」</a>
                    <span class="post-item-date">(Jan 21, 2019)</span>
                </li>
                
            </ul>
        </div>
        
        
        <p>{: id=”20201220214147-35pfy1i”}</p>
<p>原创： zhangshaolin <strong>张少林同学</strong><br>微信号: zhangshaolin_tonxue<br>{: id=”20201220214147-b5wm1wi”}</p>
<p>功能介绍 分享<br>{: id=”20201220214147-ldpjgm8”}</p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>{: id=”20201220214147-lnjpnmk”}</p>
<p><code>Java</code>中的线程是使用<code>Thread</code>类实现的，<code>Thread</code>在初学<code>Java</code>的时候就学过了，也在实践中用过，不过一直没从源码的角度去看过它的实现，今天从源码的角度出发，再次学习<code>Java Thread</code>，愿此后对<code>Thread</code>的实践更加得心应手。<br>{: id=”20201220214147-5wjobqr”}</p>
<h2 id="从注释开始"><a href="#从注释开始" class="headerlink" title="从注释开始"></a>从注释开始</h2><p>{: id=”20201220214147-i97a62i”}</p>
<p>相信阅读过<code>JDK</code>源码的同学都能感受到<code>JDK</code>源码中有非常详尽的注释，阅读某个类的源码应当先看看注释对它的介绍，注释原文就不贴了，以下是我对它的总结：<br>{: id=”20201220214147-lsel47v”}</p>
<ul>
<li>{: id=”20201220214147-bzcrgpv”}<code>Thread</code>是程序中执行的线程，<code>Java</code>虚拟机允许应用程序同时允许多个执行线程<br>{: id=”20201220214147-akpfoe0”}</li>
<li>{: id=”20201220214147-nu5hrog”}每个线程都有优先级的概念，具有较高优先级的线程优先于优先级较低的线程执行<br>{: id=”20201220214147-bvk3b8f”}</li>
<li>{: id=”20201220214147-ijowpwo”}每个线程都可以被设置为守护线程<br>{: id=”20201220214147-q7qyqk4”}</li>
<li>{: id=”20201220214147-k81m696”}当在某个线程中运行的代码创建一个新的<code>Thread</code>对象时，新的线程优先级跟创建线程一致<br>{: id=”20201220214147-b9ohmxi”}</li>
<li>{: id=”20201220214147-j21jn2p”}当<code>Java</code>虚拟机启动的时候都会启动一个叫做<code>main</code>的线程，它没有守护线程，<code>main</code>线程会继续执行，直到以下情况发送<br>{: id=”20201220214147-otqc1te”}</li>
<li>{: id=”20201220214147-fbdy6gn”}<code>Runtime</code> 类的退出方法<code>exit</code>被调用并且安全管理器允许进行退出操作<br>{: id=”20201220214147-ogvfhzr”}</li>
<li>{: id=”20201220214147-12dyus7”}所有非守护线程均已死亡，或者<code>run</code>方法执行结束正常返回结果，或者<code>run</code>方法抛出异常<br>{: id=”20201220214147-vjy4lmc”}</li>
<li>{: id=”20201220214147-5ynh8lu”}创建线程第一种方式：继承<code>Thread</code>类，重写<code>run</code>方法<br>{: id=”20201220214147-pzplndo”}<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> 1  &#x2F;&#x2F;定义线程类</span><br><span class="line"> 2  class PrimeThread extends Thread &#123;</span><br><span class="line"> 3        long minPrime;</span><br><span class="line"> 4        PrimeThread(long minPrime) &#123;</span><br><span class="line"> 5            this.minPrime &#x3D; minPrime;</span><br><span class="line"> 6        &#125;</span><br><span class="line"> 7        public void run() &#123;</span><br><span class="line"> 8            &#x2F;&#x2F; compute primes larger than minPrime</span><br><span class="line"> 9            &amp;nbsp;.&amp;nbsp;.&amp;nbsp;.</span><br><span class="line">10        &#125;</span><br><span class="line">11    &#125;</span><br><span class="line">12  &#x2F;&#x2F;启动线程</span><br><span class="line">13  PrimeThread p &#x3D; new PrimeThread(143);</span><br><span class="line">14  p.start();</span><br></pre></td></tr></table></figure>
{: id=”20201220214147-rkplhv6”}</li>
<li>{: id=”20201220214147-yw5mieq”}创建线程第二种方式：实现<code>Runnable</code>接口，重写<code>run</code>方法，因为<code>Java</code>的单继承限制，通常使用这种方式创建线程更加灵活<br>{: id=”20201220214147-qyivdw1”}<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> 1  &#x2F;&#x2F;定义线程</span><br><span class="line"> 2   class PrimeRun implements Runnable &#123;</span><br><span class="line"> 3        long minPrime;</span><br><span class="line"> 4        PrimeRun(long minPrime) &#123;</span><br><span class="line"> 5            this.minPrime &#x3D; minPrime;</span><br><span class="line"> 6        &#125;</span><br><span class="line"> 7        public void run() &#123;</span><br><span class="line"> 8            &#x2F;&#x2F; compute primes larger than minPrime</span><br><span class="line"> 9            &amp;nbsp;.&amp;nbsp;.&amp;nbsp;.</span><br><span class="line">10        &#125;</span><br><span class="line">11    &#125;</span><br><span class="line">12  &#x2F;&#x2F;启动线程</span><br><span class="line">13  PrimeRun p &#x3D; new PrimeRun(143);</span><br><span class="line">14  new Thread(p).start();</span><br></pre></td></tr></table></figure>
{: id=”20201220214147-zcszphp”}</li>
<li>{: id=”20201220214147-g48kq2i”}创建线程时可以给线程指定名字，如果没有指定，会自动为它生成名字<br>{: id=”20201220214147-fddbrt5”}</li>
<li>{: id=”20201220214147-7nzjr56”}除非另有说明，否则将<code>null</code>参数传递给<code>Thread</code>类中的构造函数或方法将导致抛出 <code>NullPointerException</code><br>{: id=”20201220214147-hwoidx3”}<br>{: id=”20201220214147-kjk5gla”}</li>
</ul>
<h2 id="Thread-常用属性"><a href="#Thread-常用属性" class="headerlink" title="Thread 常用属性"></a>Thread 常用属性</h2><p>{: id=”20201220214147-b7y0tac”}</p>
<p>阅读一个<code>Java</code>类，先从它拥有哪些属性入手：<br>{: id=”20201220214147-9xl1tbp”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"> 1  &#x2F;&#x2F;线程名称，创建线程时可以指定线程的名称</span><br><span class="line"> 2  private volatile String name;</span><br><span class="line"> 3  </span><br><span class="line"> 4  &#x2F;&#x2F;线程优先级，可以设置线程的优先级</span><br><span class="line"> 5  private int priority;</span><br><span class="line"> 6  </span><br><span class="line"> 7  &#x2F;&#x2F;可以配置线程是否为守护线程，默认为false</span><br><span class="line"> 8  private boolean daemon &#x3D; false;</span><br><span class="line"> 9  </span><br><span class="line">10  &#x2F;&#x2F;最终执行线程任务的&#96;Runnable&#96;</span><br><span class="line">11  private Runnable target;</span><br><span class="line">12  </span><br><span class="line">13  &#x2F;&#x2F;描述线程组的类</span><br><span class="line">14  private ThreadGroup group;</span><br><span class="line">15  </span><br><span class="line">16  &#x2F;&#x2F;此线程的上下文ClassLoader</span><br><span class="line">17  private ClassLoader contextClassLoader;</span><br><span class="line">18  </span><br><span class="line">19  &#x2F;&#x2F;所有初始化线程的数目，用于自动编号匿名线程，当没有指定线程名称时，会自动为其编号</span><br><span class="line">20  private static int threadInitNumber;</span><br><span class="line">21  </span><br><span class="line">22  &#x2F;&#x2F;此线程请求的堆栈大小，如果创建者没有指定堆栈大小，则为0。, 虚拟机可以用这个数字做任何喜欢的事情。, 一些虚拟机会忽略它。</span><br><span class="line">23  private long stackSize;</span><br><span class="line">24  </span><br><span class="line">25  &#x2F;&#x2F;线程id</span><br><span class="line">26  private long tid;</span><br><span class="line">27  </span><br><span class="line">28  &#x2F;&#x2F;用于生成线程ID</span><br><span class="line">29  private static long threadSeqNumber;</span><br><span class="line">30  </span><br><span class="line">31  &#x2F;&#x2F;线程状态</span><br><span class="line">32  private volatile int threadStatus &#x3D; 0;</span><br><span class="line">33  </span><br><span class="line">34  &#x2F;&#x2F;线程可以拥有的最低优先级</span><br><span class="line">35  public final static int MIN_PRIORITY &#x3D; 1;</span><br><span class="line">36  </span><br><span class="line">37  &#x2F;&#x2F;分配给线程的默认优先级。</span><br><span class="line">38  public final static int NORM_PRIORITY &#x3D; 5;</span><br><span class="line">39  </span><br><span class="line">40  &#x2F;&#x2F;线程可以拥有的最大优先级</span><br><span class="line">41  public final static int MAX_PRIORITY &#x3D; 10;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-i3pvykw”}</p>
<h2 id="Thread-构造方法"><a href="#Thread-构造方法" class="headerlink" title="Thread 构造方法"></a>Thread 构造方法</h2><p>{: id=”20201220214147-iguo0u8”}</p>
<p>了解了属性之后，看看<code>Thread</code>实例是怎么构造的？先预览下它大致有多少个构造方法：<br>{: id=”20201220214147-4uisx2l”}</p>
<p><img src="/assets/uploads/files/1548122247324-a77dcb75-2e68-4785-81f8-a4b242b67382-image.png" alt="a77dcb75-2e68-4785-81f8-a4b242b67382-image.png"><br>{: id=”20201220214147-gvjobev”}</p>
<p>查看每个构造方法内部源码，发现均调用的是名为<code>init</code>的私有方法，再看<code>init</code>方法有两个重载，而其核心方法如下：<br>{: id=”20201220214147-onyn57a”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"> 1   &#x2F;**</span><br><span class="line"> 2     * Initializes a Thread.</span><br><span class="line"> 3     *</span><br><span class="line"> 4     * @param g                   线程组</span><br><span class="line"> 5     * @param target              最终执行任务的 &#96;run()&#96; 方法的对象</span><br><span class="line"> 6     * @param name                新线程的名称</span><br><span class="line"> 7     * @param stackSize           新线程所需的堆栈大小，或者 0 表示要忽略此参数</span><br><span class="line"> 8     * @param acc                 要继承的AccessControlContext，如果为null，则为 AccessController.getContext()</span><br><span class="line"> 9     * @param inheritThreadLocals 如果为 true，从构造线程继承可继承的线程局部的初始值</span><br><span class="line">10     *&#x2F;</span><br><span class="line">11    private void init(ThreadGroup g, Runnable target, String name,</span><br><span class="line">12                      long stackSize, AccessControlContext acc,</span><br><span class="line">13                      boolean inheritThreadLocals) &#123;</span><br><span class="line">14        &#x2F;&#x2F;线程名称为空，直接抛出空指针异常</span><br><span class="line">15        if (name &#x3D;&#x3D; null) &#123;</span><br><span class="line">16            throw new NullPointerException(&quot;name cannot be null&quot;);</span><br><span class="line">17        &#125;</span><br><span class="line">18        &#x2F;&#x2F;初始化当前线程对象的线程名称</span><br><span class="line">19        this.name &#x3D; name;</span><br><span class="line">20        &#x2F;&#x2F;获取当前正在执行的线程为父线程</span><br><span class="line">21        Thread parent &#x3D; currentThread();</span><br><span class="line">22        &#x2F;&#x2F;获取系统安全管理器</span><br><span class="line">23        SecurityManager security &#x3D; System.getSecurityManager();</span><br><span class="line">24        &#x2F;&#x2F;如果线程组为空</span><br><span class="line">25        if (g &#x3D;&#x3D; null) &#123;</span><br><span class="line">26            &#x2F;&#x2F;如果安全管理器不为空</span><br><span class="line">27            if (security !&#x3D; null) &#123;</span><br><span class="line">28                &#x2F;&#x2F;获取SecurityManager中的线程组</span><br><span class="line">29                g &#x3D; security.getThreadGroup();</span><br><span class="line">30            &#125;</span><br><span class="line">31            &#x2F;&#x2F;如果获取的线程组还是为空</span><br><span class="line">32            if (g &#x3D;&#x3D; null) &#123;</span><br><span class="line">33                &#x2F;&#x2F;则使用父线程的线程组</span><br><span class="line">34                g &#x3D; parent.getThreadGroup();</span><br><span class="line">35            &#125;</span><br><span class="line">36        &#125;</span><br><span class="line">37</span><br><span class="line">38        &#x2F;&#x2F;检查安全权限</span><br><span class="line">39        g.checkAccess();</span><br><span class="line">40</span><br><span class="line">41        &#x2F;&#x2F;使用安全管理器检查是否有权限</span><br><span class="line">42        if (security !&#x3D; null) &#123;</span><br><span class="line">43            if (isCCLOverridden(getClass())) &#123;</span><br><span class="line">44                security.checkPermission(SUBCLASS_IMPLEMENTATION_PERMISSION);</span><br><span class="line">45            &#125;</span><br><span class="line">46        &#125;</span><br><span class="line">47</span><br><span class="line">48        &#x2F;&#x2F;线程组中标记未启动的线程数+1，这里方法是同步的，防止出现线程安全问题</span><br><span class="line">49        g.addUnstarted();</span><br><span class="line">50</span><br><span class="line">51        &#x2F;&#x2F;初始化当前线程对象的线程组</span><br><span class="line">52        this.group &#x3D; g;</span><br><span class="line">53        &#x2F;&#x2F;初始化当前线程对象的是否守护线程属性，注意到这里初始化时跟父线程一致</span><br><span class="line">54        this.daemon &#x3D; parent.isDaemon();</span><br><span class="line">55        &#x2F;&#x2F;初始化当前线程对象的线程优先级属性，注意到这里初始化时跟父线程一致</span><br><span class="line">56        this.priority &#x3D; parent.getPriority();</span><br><span class="line">57        &#x2F;&#x2F;这里初始化类加载器</span><br><span class="line">58        if (security &#x3D;&#x3D; null || isCCLOverridden(parent.getClass()))</span><br><span class="line">59            this.contextClassLoader &#x3D; parent.getContextClassLoader();</span><br><span class="line">60        else</span><br><span class="line">61            this.contextClassLoader &#x3D; parent.contextClassLoader;</span><br><span class="line">62        this.inheritedAccessControlContext &#x3D;</span><br><span class="line">63                acc !&#x3D; null ? acc : AccessController.getContext();</span><br><span class="line">64        &#x2F;&#x2F;初始化当前线程对象的最终执行任务对象</span><br><span class="line">65        this.target &#x3D; target;</span><br><span class="line">66        &#x2F;&#x2F;这里再对线程的优先级字段进行处理</span><br><span class="line">67        setPriority(priority);</span><br><span class="line">68        if (inheritThreadLocals &amp;&amp; parent.inheritableThreadLocals !&#x3D; null)</span><br><span class="line">69            this.inheritableThreadLocals &#x3D;</span><br><span class="line">70                ThreadLocal.createInheritedMap(parent.inheritableThreadLocals);</span><br><span class="line">71        &#x2F;&#x2F;初始化当前线程对象的堆栈大小</span><br><span class="line">72        this.stackSize &#x3D; stackSize;</span><br><span class="line">73</span><br><span class="line">74        &#x2F;&#x2F;初始化当前线程对象的线程ID，该方法是同步的，内部实际上是threadSeqNumber++</span><br><span class="line">75        tid &#x3D; nextThreadID();</span><br><span class="line">76    &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-yhwkmro”}</p>
<p>另一个重载<code>init</code>私有方法如下，实际上内部调用的是上述<code>init</code>方法：<br>{: id=”20201220214147-ssmeqkf”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1   private void init(ThreadGroup g, Runnable target, String name,</span><br><span class="line">2                      long stackSize) &#123;</span><br><span class="line">3        init(g, target, name, stackSize, null, true);</span><br><span class="line">4   &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-29eajrc”}</p>
<p>接下来看看所有构造方法：<br>{: id=”20201220214147-q4pi6hb”}</p>
<ol>
<li><p>{: id=”20201220214147-94en0g3”}空构造方法<br>{: id=”20201220214147-829xvw6”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1    public Thread() &#123;</span><br><span class="line">2        init(null, null, &quot;Thread-&quot; + nextThreadNum(), 0);</span><br><span class="line">3    &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-fyc9pqv”}</p>
<p>内部调用的是<code>init</code>第二个重载方法，参数基本都是默认值，线程名称写死为<code>&quot;Thread-&quot; + nextThreadNum()</code>格式，<code>nextThreadNum()</code>为一个同步方法，内部维护一个静态属性表示线程的初始化数量+1：<br>{: id=”20201220214147-jzopo72”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1   private static int threadInitNumber;</span><br><span class="line">2    private static synchronized int nextThreadNum() &#123;</span><br><span class="line">3        return threadInitNumber++;</span><br><span class="line">4    &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-o7erx1z”}</p>
<p>与第一个构造方法区别在于可以自定义<code>Runnable</code>对象<br>{: id=”20201220214147-iixjqsi”}</p>
</li>
<li><p>{: id=”20201220214147-5u5dul3”}自定义执行任务<code>Runnable</code>对象的构造方法<br>{: id=”20201220214147-9ym3z8e”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1    private static int threadInitNumber;</span><br><span class="line">2    private static synchronized int nextThreadNum() &#123;</span><br><span class="line">3        return threadInitNumber++;</span><br><span class="line">4    &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-ojqxn67”}</p>
</li>
<li><p>{: id=”20201220214147-pda9mb1”}自定义执行任务<code>Runnable</code>对象和<code>AccessControlContext</code>对象的构造方法<br>{: id=”20201220214147-ianowtw”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1 Thread(Runnable target, AccessControlContext acc) &#123;</span><br><span class="line">2    init(null, target, &quot;Thread-&quot; + nextThreadNum(), 0, acc, false);</span><br><span class="line">3 &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-2d6ciaa”}</p>
</li>
<li><p>{: id=”20201220214147-ywoitde”}自定义线程组<code>ThreadGroup</code>和执行任务<code>Runnable</code>对象的构造方法<br>{: id=”20201220214147-2sqtoky”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1  public Thread(ThreadGroup group, Runnable target) &#123;</span><br><span class="line">2    init(group, target, &quot;Thread-&quot; + nextThreadNum(), 0);</span><br><span class="line">3  &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-0iaozce”}</p>
</li>
<li><p>{: id=”20201220214147-hhauzva”}自定义线程名称<code>name</code>的构造方法<br>{: id=”20201220214147-scei78m”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1  public Thread(String name) &#123;</span><br><span class="line">2    init(null, null, name, 0);</span><br><span class="line">3  &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-3f7ot4w”}</p>
</li>
<li><p>{: id=”20201220214147-q22qivj”}自定义线程组<code>ThreadGroup</code>和线程名称<code>name</code>的构造方法<br>{: id=”20201220214147-1uz0h2q”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1  public Thread(String name) &#123;</span><br><span class="line">2     init(null, null, name, 0);</span><br><span class="line">3  &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-8mnsmk0”}</p>
</li>
<li><p>{: id=”20201220214147-t1qzg2r”}自定义执行任务<code>Runnable</code>对象和线程名称<code>name</code>的构造方法<br>{: id=”20201220214147-6tnfm8u”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1  public Thread(Runnable target, String name) &#123;</span><br><span class="line">2     init(null, target, name, 0);</span><br><span class="line">3  &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-w3vn3ek”}</p>
</li>
<li><p>{: id=”20201220214147-50mp1zb”}自定义线程组<code>ThreadGroup</code>和线程名称<code>name</code>和执行任务<code>Runnable</code>对象的构造方法<br>{: id=”20201220214147-u4kbc4v”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1  public Thread(ThreadGroup group, Runnable target, String name) &#123;</span><br><span class="line">2     init(group, target, name, 0);</span><br><span class="line">3  &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-kkq9mly”}</p>
</li>
<li><p>{: id=”20201220214147-vgxv9jj”}全部属性都是自定义的构造方法<br>{: id=”20201220214147-yqaz25l”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1  public Thread(ThreadGroup group, Runnable target, String name,</span><br><span class="line">2                long stackSize) &#123;</span><br><span class="line">3     init(group, target, name, stackSize);</span><br><span class="line">4  &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-om0i3qj”}<br>{: id=”20201220214147-ov4v0gy”}</p>
</li>
</ol>
<p><code>Thread</code>提供了非常灵活的重载构造方法，方便开发者自定义各种参数的<code>Thread</code>对象。<br>{: id=”20201220214147-3ojp02w”}</p>
<h2 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h2><p>{: id=”20201220214147-kb17bg1”}</p>
<p>这里记录一些比较常见的方法吧，对于<code>Thread</code>中存在的一些本地方法，我们暂且不用管它～<br>{: id=”20201220214147-51xbiv2”}</p>
<h4 id="设置线程名称"><a href="#设置线程名称" class="headerlink" title="设置线程名称"></a>设置线程名称</h4><p>{: id=”20201220214147-gm8gx4i”}</p>
<p>设置线程名称，该方法为同步方法，为了防止出现线程安全问题，可以手动调用<code>Thread</code>的实例方法设置名称，也可以在构造<code>Thread</code>时在构造方法中传入线程名称，我们通常都是在构造参数时设置<br>{: id=”20201220214147-3wjwex4”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> 1   public final synchronized void setName(String name) &#123;</span><br><span class="line"> 2       　　&#x2F;&#x2F;检查安全权限</span><br><span class="line"> 3          checkAccess();</span><br><span class="line"> 4       　　&#x2F;&#x2F;如果形参为空，抛出空指针异常</span><br><span class="line"> 5          if (name &#x3D;&#x3D; null) &#123;</span><br><span class="line"> 6              throw new NullPointerException(&quot;name cannot be null&quot;);</span><br><span class="line"> 7          &#125;</span><br><span class="line"> 8        &#x2F;&#x2F;给当前线程对象设置名称</span><br><span class="line"> 9          this.name &#x3D; name;</span><br><span class="line">10          if (threadStatus !&#x3D; 0) &#123;</span><br><span class="line">11              setNativeName(name);</span><br><span class="line">12          &#125;</span><br><span class="line">13      &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-09npsvg”}</p>
<h4 id="获取线程名称"><a href="#获取线程名称" class="headerlink" title="获取线程名称"></a>获取线程名称</h4><p>{: id=”20201220214147-wx74bdo”}</p>
<p>内部直接返回当前线程对象的名称属性<br>{: id=”20201220214147-215ovoz”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1  public final String getName() &#123;</span><br><span class="line">2        return name;</span><br><span class="line">3    &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-3ogp31b”}</p>
<h4 id="启动线程"><a href="#启动线程" class="headerlink" title="启动线程"></a>启动线程</h4><p>{: id=”20201220214147-8oh8o8k”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"> 1  public synchronized void start() &#123;</span><br><span class="line"> 2      &#x2F;&#x2F;如果不是刚创建的线程，抛出异常</span><br><span class="line"> 3      if (threadStatus !&#x3D; 0)</span><br><span class="line"> 4          throw new IllegalThreadStateException();</span><br><span class="line"> 5</span><br><span class="line"> 6      &#x2F;&#x2F;通知线程组，当前线程即将启动，线程组当前启动线程数+1，未启动线程数-1</span><br><span class="line"> 7      group.add(this);</span><br><span class="line"> 8</span><br><span class="line"> 9      &#x2F;&#x2F;启动标识</span><br><span class="line">10      boolean started &#x3D; false;</span><br><span class="line">11      try &#123;</span><br><span class="line">12          &#x2F;&#x2F;直接调用本地方法启动线程</span><br><span class="line">13          start0();</span><br><span class="line">14          &#x2F;&#x2F;设置启动标识为启动成功</span><br><span class="line">15          started &#x3D; true;</span><br><span class="line">16      &#125; finally &#123;</span><br><span class="line">17          try &#123;</span><br><span class="line">18              &#x2F;&#x2F;如果启动呢失败</span><br><span class="line">19              if (!started) &#123;</span><br><span class="line">20                  &#x2F;&#x2F;线程组内部移除当前启动的线程数量-1，同时启动失败的线程数量+1</span><br><span class="line">21                  group.threadStartFailed(this);</span><br><span class="line">22              &#125;</span><br><span class="line">23          &#125; catch (Throwable ignore) &#123;</span><br><span class="line">24              &#x2F;* do nothing. If start0 threw a Throwable then</span><br><span class="line">25                it will be passed up the call stack *&#x2F;</span><br><span class="line">26          &#125;</span><br><span class="line">27      &#125;</span><br><span class="line">28  &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-dbu2un6”}</p>
<p>我们正常的启动线程都是调用<code>Thread</code>的<code>start()</code>方法，然后<code>Java</code>虚拟机内部会去调用<code>Thred</code>的<code>run</code>方法，可以看到<code>Thread</code>类也是实现<code>Runnable</code>接口，重写了<code>run</code>方法的：<br>{: id=”20201220214147-ru3l5gl”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1 @Override</span><br><span class="line">2 public void run() &#123;</span><br><span class="line">3     &#x2F;&#x2F;当前执行任务的Runnable对象不为空，则调用其run方法</span><br><span class="line">4     if (target !&#x3D; null) &#123;</span><br><span class="line">5         target.run();</span><br><span class="line">6     &#125;</span><br><span class="line">7 &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-ngtq2hy”}</p>
<p><code>Thread</code>的两种使用方式：<br>{: id=”20201220214147-kt2jmia”}</p>
<ul>
<li>{: id=”20201220214147-0jbq8xw”}继承<code>Thread</code>类，重写<code>run</code>方法，那么此时是直接执行<code>run</code>方法的逻辑，不会使用<code>target.run();</code><br>{: id=”20201220214147-idffp4h”}</li>
<li>{: id=”20201220214147-deru4fm”}实现<code>Runnable</code>接口，重写<code>run</code>方法，因为<code>Java</code>的单继承限制，通常使用这种方式创建线程更加灵活，这里真正的执行逻辑就会交给自定义<code>Runnable</code>去实现<br>{: id=”20201220214147-ne7ibmz”}<br>{: id=”20201220214147-lbo5fkl”}</li>
</ul>
<h4 id="设置守护线程"><a href="#设置守护线程" class="headerlink" title="设置守护线程"></a>设置守护线程</h4><p>{: id=”20201220214147-2mh2x45”}</p>
<p>本质操作是设置<code>daemon</code>属性<br>{: id=”20201220214147-c9toib0”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> 1  public final void setDaemon(boolean on) &#123;</span><br><span class="line"> 2      &#x2F;&#x2F;检查是否有安全权限</span><br><span class="line"> 3      checkAccess();</span><br><span class="line"> 4      &#x2F;&#x2F;本地方法，测试此线程是否存活。, 如果一个线程已经启动并且尚未死亡，则该线程处于活动状态</span><br><span class="line"> 5      if (isAlive()) &#123;</span><br><span class="line"> 6          &#x2F;&#x2F;如果线程先启动后再设置守护线程，将抛出异常</span><br><span class="line"> 7          throw new IllegalThreadStateException();</span><br><span class="line"> 8      &#125;</span><br><span class="line"> 9      &#x2F;&#x2F;设置当前守护线程属性</span><br><span class="line">10      daemon &#x3D; on;</span><br><span class="line">11  &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-1tbdeto”}</p>
<h4 id="判断线程是否为守护线程"><a href="#判断线程是否为守护线程" class="headerlink" title="判断线程是否为守护线程"></a>判断线程是否为守护线程</h4><p>{: id=”20201220214147-xe5yfxj”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1 public final boolean isDaemon() &#123;</span><br><span class="line">2     &#x2F;&#x2F;直接返回当前对象的守护线程属性</span><br><span class="line">3     return daemon;</span><br><span class="line">4 &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-b6s25tf”}</p>
<h4 id="线程状态"><a href="#线程状态" class="headerlink" title="线程状态"></a>线程状态</h4><p>{: id=”20201220214147-rars5jk”}</p>
<p>先来个线程状态图：<br>{: id=”20201220214147-neu4m4z”}</p>
<p><img src="./2019-01-21_java_thread_source/java_thread_source_1.png" alt="java_thread_source_1.png"><br>{: id=”20201220214147-z33znva”}</p>
<p>获取线程状态：<br>{: id=”20201220214147-heequwi”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1 public State getState() &#123;</span><br><span class="line">2     &#x2F;&#x2F;由虚拟机实现，获取当前线程的状态</span><br><span class="line">3     return sun.misc.VM.toThreadState(threadStatus);</span><br><span class="line">4 &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-f1s4pcj”}</p>
<p>线程状态主要由内部枚举类<code>State</code>组成：<br>{: id=”20201220214147-gbgl2f0”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> 1  public enum State &#123;</span><br><span class="line"> 2</span><br><span class="line"> 3     NEW,</span><br><span class="line"> 4</span><br><span class="line"> 5</span><br><span class="line"> 6     RUNNABLE,</span><br><span class="line"> 7</span><br><span class="line"> 8</span><br><span class="line"> 9     BLOCKED,</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12     WAITING,</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15     TIMED_WAITING,</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18     TERMINATED;</span><br><span class="line">19 &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-q3iy1nt”}</p>
<ul>
<li>{: id=”20201220214147-hpis15t”}NEW：刚刚创建，尚未启动的线程处于此状态<br>{: id=”20201220214147-oomoz1k”}</li>
<li>{: id=”20201220214147-zzvnvfj”}RUNNABLE：在Java虚拟机中执行的线程处于此状态<br>{: id=”20201220214147-ds506g4”}</li>
<li>{: id=”20201220214147-arbfogt”}BLOCKED：被阻塞等待监视器锁的线程处于此状态，比如线程在执行过程中遇到<code>synchronized</code>同步块，就会进入此状态，此时线程暂停执行，直到获得请求的锁<br>{: id=”20201220214147-t2x0fuo”}</li>
<li>{: id=”20201220214147-zy9mk78”}WAITING：无限期等待另一个线程执行特定操作的线程处于此状态<br>{: id=”20201220214147-cp2c77z”}</li>
<li>{: id=”20201220214147-2hwfqmc”}通过 wait() 方法等待的线程在等待 notify() 方法<br>{: id=”20201220214147-jbe3rhl”}</li>
<li>{: id=”20201220214147-j35091b”}通过 join() 方法等待的线程则会等待目标线程的终止<br>{: id=”20201220214147-8m17akq”}</li>
<li>{: id=”20201220214147-fxrt2wd”}TIMED_WAITING：正在等待另一个线程执行动作，直到指定等待时间的线程处于此状态<br>{: id=”20201220214147-lorketb”}</li>
<li>{: id=”20201220214147-tt56qct”}通过 wait() 方法，携带超时时间，等待的线程在等待 notify() 方法<br>{: id=”20201220214147-i9lf69i”}</li>
<li>{: id=”20201220214147-8i8tni4”}通过 join() 方法，携带超时时间，等待的线程则会等待目标线程的终止<br>{: id=”20201220214147-1txvmtr”}</li>
<li>{: id=”20201220214147-0ol57uy”}TERMINATED：已退出的线程处于此状态，此时线程无法再回到 RUNNABLE 状态<br>{: id=”20201220214147-c953i5m”}<br>{: id=”20201220214147-qhzmfmg”}</li>
</ul>
<h4 id="线程休眠"><a href="#线程休眠" class="headerlink" title="线程休眠"></a>线程休眠</h4><p>{: id=”20201220214147-m3uh01s”}</p>
<p>这是一个静态的本地方法，使当前执行的线程休眠暂停执行 <code>millis</code> 毫秒，当休眠被中断时会抛出<code>InterruptedException</code>中断异常<br>{: id=”20201220214147-xv5w0s1”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> 1 &#x2F;**</span><br><span class="line"> 2  * Causes the currently executing thread to sleep (temporarily cease</span><br><span class="line"> 3  * execution) for the specified number of milliseconds, subject to</span><br><span class="line"> 4  * the precision and accuracy of system timers and schedulers. The thread</span><br><span class="line"> 5  * does not lose ownership of any monitors.</span><br><span class="line"> 6  *</span><br><span class="line"> 7  * @param  millis</span><br><span class="line"> 8  *         the length of time to sleep in milliseconds</span><br><span class="line"> 9  *</span><br><span class="line">10  * @throws  IllegalArgumentException</span><br><span class="line">11  *          if the value of &#123;@code millis&#125; is negative</span><br><span class="line">12  *</span><br><span class="line">13  * @throws  InterruptedException</span><br><span class="line">14  *          if any thread has interrupted the current thread. The</span><br><span class="line">15  *          &lt;i&gt;interrupted status&lt;&#x2F;i&gt; of the current thread is</span><br><span class="line">16  *          cleared when this exception is thrown.</span><br><span class="line">17  *&#x2F;</span><br><span class="line">18 public static native void sleep(long millis) throws InterruptedException;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-lj0natr”}</p>
<h4 id="检查线程是否存活"><a href="#检查线程是否存活" class="headerlink" title="检查线程是否存活"></a>检查线程是否存活</h4><p>{: id=”20201220214147-e1c3ry2”}</p>
<p>本地方法，测试此线程是否存活。 如果一个线程已经启动并且尚未死亡，则该线程处于活动状态。<br>{: id=”20201220214147-80y0svh”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1  &#x2F;**</span><br><span class="line">2   * Tests if this thread is alive. A thread is alive if it has</span><br><span class="line">3   * been started and has not yet died.</span><br><span class="line">4   *</span><br><span class="line">5   * @return  &lt;code&gt;true&lt;&#x2F;code&gt; if this thread is alive;</span><br><span class="line">6   *          &lt;code&gt;false&lt;&#x2F;code&gt; otherwise.</span><br><span class="line">7   *&#x2F;</span><br><span class="line">8  public final native boolean isAlive();</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-r7x4l08”}</p>
<h4 id="线程优先级"><a href="#线程优先级" class="headerlink" title="线程优先级"></a>线程优先级</h4><p>{: id=”20201220214147-i934u9a”}</p>
<ul>
<li><p>{: id=”20201220214147-g9pb78m”}设置线程优先级<br>{: id=”20201220214147-2vs54mr”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"> 1  &#x2F;**</span><br><span class="line"> 2   * Changes the priority of this thread.</span><br><span class="line"> 3   * &lt;p&gt;</span><br><span class="line"> 4   * First the &lt;code&gt;checkAccess&lt;&#x2F;code&gt; method of this thread is called</span><br><span class="line"> 5   * with no arguments. This may result in throwing a</span><br><span class="line"> 6   * &lt;code&gt;SecurityException&lt;&#x2F;code&gt;.</span><br><span class="line"> 7   * &lt;p&gt;</span><br><span class="line"> 8   * Otherwise, the priority of this thread is set to the smaller of</span><br><span class="line"> 9   * the specified &lt;code&gt;newPriority&lt;&#x2F;code&gt; and the maximum permitted</span><br><span class="line">10   * priority of the thread&#39;s thread group.</span><br><span class="line">11   *</span><br><span class="line">12   * @param newPriority priority to set this thread to</span><br><span class="line">13   * @exception  IllegalArgumentException  If the priority is not in the</span><br><span class="line">14   *               range &lt;code&gt;MIN_PRIORITY&lt;&#x2F;code&gt; to</span><br><span class="line">15   *               &lt;code&gt;MAX_PRIORITY&lt;&#x2F;code&gt;.</span><br><span class="line">16   * @exception  SecurityException  if the current thread cannot modify</span><br><span class="line">17   *               this thread.</span><br><span class="line">18   * @see        #getPriority</span><br><span class="line">19   * @see        #checkAccess()</span><br><span class="line">20   * @see        #getThreadGroup()</span><br><span class="line">21   * @see        #MAX_PRIORITY</span><br><span class="line">22   * @see        #MIN_PRIORITY</span><br><span class="line">23   * @see        ThreadGroup#getMaxPriority()</span><br><span class="line">24   *&#x2F;</span><br><span class="line">25  public final void setPriority(int newPriority) &#123;</span><br><span class="line">26      &#x2F;&#x2F;线程组</span><br><span class="line">27      ThreadGroup g;</span><br><span class="line">28      &#x2F;&#x2F;检查安全权限</span><br><span class="line">29      checkAccess();</span><br><span class="line">30      &#x2F;&#x2F;检查优先级形参范围</span><br><span class="line">31      if (newPriority &gt; MAX_PRIORITY || newPriority &lt; MIN_PRIORITY) &#123;</span><br><span class="line">32          throw new IllegalArgumentException();</span><br><span class="line">33      &#125;</span><br><span class="line">34      if((g &#x3D; getThreadGroup()) !&#x3D; null) &#123;</span><br><span class="line">35          &#x2F;&#x2F;如果优先级形参大于线程组最大线程最大优先级</span><br><span class="line">36          if (newPriority &gt; g.getMaxPriority()) &#123;</span><br><span class="line">37              &#x2F;&#x2F;则使用线程组的优先级数据</span><br><span class="line">38              newPriority &#x3D; g.getMaxPriority();</span><br><span class="line">39          &#125;</span><br><span class="line">40          &#x2F;&#x2F;调用本地设置线程优先级方法</span><br><span class="line">41          setPriority0(priority &#x3D; newPriority);</span><br><span class="line">42      &#125;</span><br><span class="line">43  &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-yfolep0”}<br>{: id=”20201220214147-up8l405”}</p>
</li>
</ul>
<h4 id="线程中断"><a href="#线程中断" class="headerlink" title="线程中断"></a>线程中断</h4><p>{: id=”20201220214147-3ub4yio”}</p>
<p>有一个<code>stop()</code>实例方法可以强制终止线程，不过这个方法因为太过于暴力，已经被标记为过时方法，不建议程序员再使用，因为<strong>强制终止线程</strong>会导致数据不一致的问题。<br>{: id=”20201220214147-f8zj7i8”}</p>
<p>这里关于线程中断的方法涉及三个：<br>{: id=”20201220214147-g6hb1ae”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1 &#x2F;&#x2F;实例方法，通知线程中断，设置标志位</span><br><span class="line">2 public void interrupt()&#123;&#125;</span><br><span class="line">3 &#x2F;&#x2F;静态方法，检查当前线程的中断状态，同时会清除当前线程的中断标志位状态</span><br><span class="line">4 public static boolean interrupted()&#123;&#125;</span><br><span class="line">5 &#x2F;&#x2F;实例方法，检查当前线程是否被中断，其实是检查中断标志位</span><br><span class="line">6 public boolean isInterrupted()&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-ie77llj”}</p>
<p><strong>interrupt() 方法解析</strong><br>{: id=”20201220214147-twv3skm”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"> 1  &#x2F;**</span><br><span class="line"> 2   * Interrupts this thread.</span><br><span class="line"> 3   *</span><br><span class="line"> 4   * &lt;p&gt; Unless the current thread is interrupting itself, which is</span><br><span class="line"> 5   * always permitted, the &#123;@link #checkAccess() checkAccess&#125; method</span><br><span class="line"> 6   * of this thread is invoked, which may cause a &#123;@link</span><br><span class="line"> 7   * SecurityException&#125; to be thrown.</span><br><span class="line"> 8   *</span><br><span class="line"> 9   * &lt;p&gt; If this thread is blocked in an invocation of the &#123;@link</span><br><span class="line">10   * Object#wait() wait()&#125;, &#123;@link Object#wait(long) wait(long)&#125;, or &#123;@link</span><br><span class="line">11   * Object#wait(long, int) wait(long, int)&#125; methods of the &#123;@link Object&#125;</span><br><span class="line">12   * class, or of the &#123;@link #join()&#125;, &#123;@link #join(long)&#125;, &#123;@link</span><br><span class="line">13   * #join(long, int)&#125;, &#123;@link #sleep(long)&#125;, or &#123;@link #sleep(long, int)&#125;,</span><br><span class="line">14   * methods of this class, then its interrupt status will be cleared and it</span><br><span class="line">15   * will receive an &#123;@link InterruptedException&#125;.</span><br><span class="line">16   *</span><br><span class="line">17   * &lt;p&gt; If this thread is blocked in an I&#x2F;O operation upon an &#123;@link</span><br><span class="line">18   * java.nio.channels.InterruptibleChannel InterruptibleChannel&#125;</span><br><span class="line">19   * then the channel will be closed, the thread&#39;s interrupt</span><br><span class="line">20   * status will be set, and the thread will receive a &#123;@link</span><br><span class="line">21   * java.nio.channels.ClosedByInterruptException&#125;.</span><br><span class="line">22   *</span><br><span class="line">23   * &lt;p&gt; If this thread is blocked in a &#123;@link java.nio.channels.Selector&#125;</span><br><span class="line">24   * then the thread&#39;s interrupt status will be set and it will return</span><br><span class="line">25   * immediately from the selection operation, possibly with a non-zero</span><br><span class="line">26   * value, just as if the selector&#39;s &#123;@link</span><br><span class="line">27   * java.nio.channels.Selector#wakeup wakeup&#125; method were invoked.</span><br><span class="line">28   *</span><br><span class="line">29   * &lt;p&gt; If none of the previous conditions hold then this thread&#39;s interrupt</span><br><span class="line">30   * status will be set. &lt;&#x2F;p&gt;</span><br><span class="line">31   *</span><br><span class="line">32   * &lt;p&gt; Interrupting a thread that is not alive need not have any effect.</span><br><span class="line">33   *</span><br><span class="line">34   * @throws  SecurityException</span><br><span class="line">35   *          if the current thread cannot modify this thread</span><br><span class="line">36   *</span><br><span class="line">37   * @revised 6.0</span><br><span class="line">38   * @spec JSR-51</span><br><span class="line">39   *&#x2F;</span><br><span class="line">40  public void interrupt() &#123;</span><br><span class="line">41      &#x2F;&#x2F;检查是否是自身调用</span><br><span class="line">42      if (this !&#x3D; Thread.currentThread())</span><br><span class="line">43          &#x2F;&#x2F;检查安全权限,这可能导致抛出&#123;@link * SecurityException&#125;。</span><br><span class="line">44          checkAccess();</span><br><span class="line">45</span><br><span class="line">46      &#x2F;&#x2F;同步代码块</span><br><span class="line">47      synchronized (blockerLock) &#123;</span><br><span class="line">48          Interruptible b &#x3D; blocker;</span><br><span class="line">49          &#x2F;&#x2F;检查是否是阻塞线程调用</span><br><span class="line">50          if (b !&#x3D; null) &#123;</span><br><span class="line">51              &#x2F;&#x2F;设置线程中断标志位</span><br><span class="line">52              interrupt0(); </span><br><span class="line">53              &#x2F;&#x2F;此时抛出异常，将中断标志位设置为false,此时我们正常会捕获该异常，重新设置中断标志位</span><br><span class="line">54              b.interrupt(this);</span><br><span class="line">55              return;</span><br><span class="line">56          &#125;</span><br><span class="line">57      &#125;</span><br><span class="line">58      &#x2F;&#x2F;如无意外，则正常设置中断标志位</span><br><span class="line">59      interrupt0();</span><br><span class="line">60  &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-suo133n”}</p>
<ul>
<li>{: id=”20201220214147-71ec3sp”}线程中断方法不会使线程立即退出，而是给线程发送一个通知，告知目标线程，有人希望你退出啦～<br>{: id=”20201220214147-i37als1”}</li>
<li>{: id=”20201220214147-opbqgz3”}只能由自身调用，否则可能会抛出 <code>SecurityException</code><br>{: id=”20201220214147-478m89p”}</li>
<li>{: id=”20201220214147-a7ou9xx”}调用中断方法是由目标线程自己决定是否中断，而如果同时调用了<code>wait</code>,<code>join</code>,<code>sleep</code>等方法，会使当前线程进入阻塞状态，此时有可能发生<code>InterruptedException</code>异常<br>{: id=”20201220214147-i8zgxot”}</li>
<li>{: id=”20201220214147-j85tb8g”}被阻塞的线程再调用中断方法是不合理的<br>{: id=”20201220214147-txldr6z”}</li>
<li>{: id=”20201220214147-9fp554i”}中断不活动的线程不会产生任何影响<br>{: id=”20201220214147-fm8ta85”}<br>{: id=”20201220214147-5rhi5vs”}</li>
</ul>
<p>检查线程是否被中断:<br>{: id=”20201220214147-44n7isb”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> 1  &#x2F;**</span><br><span class="line"> 2   * Tests whether this thread has been interrupted.  The &lt;i&gt;interrupted</span><br><span class="line"> 3   * status&lt;&#x2F;i&gt; of the thread is unaffected by this method.</span><br><span class="line"> 4</span><br><span class="line"> 5   测试此线程是否已被中断。, 线程的&lt;i&gt;中断*状态&lt;&#x2F; i&gt;不受此方法的影响。</span><br><span class="line"> 6   *</span><br><span class="line"> 7   * &lt;p&gt;A thread interruption ignored because a thread was not alive</span><br><span class="line"> 8   * at the time of the interrupt will be reflected by this method</span><br><span class="line"> 9   * returning false.</span><br><span class="line">10   *</span><br><span class="line">11   * @return  &lt;code&gt;true&lt;&#x2F;code&gt; if this thread has been interrupted;</span><br><span class="line">12   *          &lt;code&gt;false&lt;&#x2F;code&gt; otherwise.</span><br><span class="line">13   * @see     #interrupted()</span><br><span class="line">14   * @revised 6.0</span><br><span class="line">15   *&#x2F;</span><br><span class="line">16  public boolean isInterrupted() &#123;</span><br><span class="line">17      return isInterrupted(false);</span><br><span class="line">18  &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-czx5a25”}</p>
<p>静态方法,会清空当前线程的中断标志位：<br>{: id=”20201220214147-in31cu1”}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> 1   &#x2F;**</span><br><span class="line"> 2     *测试当前线程是否已被中断。, 此方法清除线程的* &lt;i&gt;中断状态&lt;&#x2F; i&gt;。, 换句话说，如果要连续两次调用此方法，则* second调用将返回false（除非当前线程再次被中断，在第一次调用已清除其中断的*状态   之后且在第二次调用已检查之前）, 它）</span><br><span class="line"> 3     *</span><br><span class="line"> 4     * &lt;p&gt;A thread interruption ignored because a thread was not alive</span><br><span class="line"> 5     * at the time of the interrupt will be reflected by this method</span><br><span class="line"> 6     * returning false.</span><br><span class="line"> 7     *</span><br><span class="line"> 8     * @return  &lt;code&gt;true&lt;&#x2F;code&gt; if the current thread has been interrupted;</span><br><span class="line"> 9     *          &lt;code&gt;false&lt;&#x2F;code&gt; otherwise.</span><br><span class="line">10     * @see #isInterrupted()</span><br><span class="line">11     * @revised 6.0</span><br><span class="line">12     *&#x2F;</span><br><span class="line">13    public static boolean interrupted() &#123;</span><br><span class="line">14        return currentThread().isInterrupted(true);</span><br><span class="line">15    &#125;</span><br></pre></td></tr></table></figure>
<p>{: id=”20201220214147-cw4k6h0”}</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>{: id=”20201220214147-oq69nhs”}</p>
<p>记录自己阅读<code>Thread</code>类源码的一些思考，不过对于其中用到的很多本地方法只能望而却步，还有一些代码没有看明白，暂且先这样吧，如果有不足之处，请留言告知我，谢谢！后续会在实践中对<code>Thread</code>做出更多总结记录。<br>{: id=”20201220214147-uzd1irl”}</p>
<p>{: id=”20201220214147-jzyafuo” type=”doc”}</p>

        
<script src="/js/qrious.min.js"></script>


        <hr>
        <div>
            
            <p>
                <span>专题: </span>
                
                <a href="/series/#Java 基础">
                    <code key="Java 基础" class="post-label">Java 基础</code>
                </a>
                
            </p>
            
            <p>
                <span>本文发表于 2019-01-21，最后修改于 2020-12-20。</span>
            </p>
            <!-- 文章末尾的提示 start -->
            
            
            
                
            <!-- 文章末尾的提示 end -->
        </div>
        <hr />
        <p name="pagination" style="font-size: 1.2em">
    
    <a class="float-left" href="/post/design/2019-01-05_Java经典设计模式_3_十一种行为型模式.html">上一篇 « Java 经典设计模式（3）：十一种行为型模式</a>
    
    
    <a class="float-right" href="/post/java/nio/2019-02-27_java_nio_model.html">下一篇 » 谈一谈 Java IO 模型</a>
    
</p>
    </article>
    <!-- 赞赏 -->
    <!--打赏-->

    <!-- 推荐阅读三篇文章 -->
    <div class="col-xs-12">
        <h3>推荐阅读</h3>
        
        <div class="post-preview">
    <div class="post-img" style="background-image: url('/images/MySQL.png')"></div>
    <div class="post-info">
        <div class="post-info-center">
            <div class="hidden-xs">
                
                
                <span>/</span>
                
                <a class="text-gray" href="/tags/#MySQL"
                    title="MySQL">MySQL</a>
                <span>/</span>
                
                <a class="text-gray" href="/tags/#性能优化"
                    title="性能优化">性能优化</a>
                <span>/</span>
                
                <a class="text-gray" href="/tags/#阅读笔记"
                    title="阅读笔记">阅读笔记</a>
                <span>/</span>
                
                
            </div>
            <a href="/post/dateabase/mysql/2020-09-11_高性能MySQL阅读笔记(2).html" class="title">
                高性能 MySQL 阅读笔记 (2)
            </a>
            <p class="text-gray">
                <small>
                    <span>发表于2020-09-10，</span>
                    <span class="hidden-xs">全文1554字，</span>
                    <span>阅读约6分钟</span>
                </small>
            </p>
        </div>
    </div>
</div>
        
        <div class="post-preview">
    <div class="post-img" style="background-image: url('/images/frontend-logo.png')"></div>
    <div class="post-info">
        <div class="post-info-center">
            <div class="hidden-xs">
                
                
                <span>/</span>
                
                <a class="text-gray" href="/tags/#JavaScript"
                    title="JavaScript">JavaScript</a>
                <span>/</span>
                
                <a class="text-gray" href="/tags/#chameleon"
                    title="chameleon">chameleon</a>
                <span>/</span>
                
                <a class="text-gray" href="/tags/#跨平台"
                    title="跨平台">跨平台</a>
                <span>/</span>
                
                <a class="text-gray" href="/tags/#小程序"
                    title="小程序">小程序</a>
                <span>/</span>
                
                
            </div>
            <a href="/post/frontend/2019-10-27_移动端跨平台方案如何选择.html" class="title">
                移动端跨平台方案如何选择
            </a>
            <p class="text-gray">
                <small>
                    <span>发表于2019-10-26，</span>
                    <span class="hidden-xs">全文860字，</span>
                    <span>阅读约3分钟</span>
                </small>
            </p>
        </div>
    </div>
</div>
        
        <div class="post-preview">
    <div class="post-img" style="background-image: url('/images/java/io.png')"></div>
    <div class="post-info">
        <div class="post-info-center">
            <div class="hidden-xs">
                
                
                <span>/</span>
                
                <a class="text-gray" href="/tags/#Java"
                    title="Java">Java</a>
                <span>/</span>
                
                <a class="text-gray" href="/tags/#NIO"
                    title="NIO">NIO</a>
                <span>/</span>
                
                <a class="text-gray" href="/tags/#Selector"
                    title="Selector">Selector</a>
                <span>/</span>
                
                
            </div>
            <a href="/post/java/nio/2017-04-23_java_nio_3.html" class="title">
                Java NIO(3) 选择器 Selector
            </a>
            <p class="text-gray">
                <small>
                    <span>发表于2017-04-22，</span>
                    <span class="hidden-xs">全文5874字，</span>
                    <span>阅读约20分钟</span>
                </small>
            </p>
        </div>
    </div>
</div>
        
    </div>
    <div class="col-xs-12">
        <!-- 标签列表 -->
        <!-- Featured Tags -->
<style>
    #featured-tag .post-tag-item {
        font-size: 12px;
        line-height: 30px;
        display: inline-block;
        height: 30px;
        margin: 5px 0px;
        padding: 0 7px;
        color: #333;
        border-radius: 15px;
        background: #f6f6f6;
    }

    #featured-tag .post-tag-item:hover {
        color: #337ab7;
    }
</style>
<div id="featured-tag">
    
    <a class="post-tag-item" href="/tags/#关于我" title="关于我"
        rel="1">#关于我 (1) </a>
    
    <a class="post-tag-item" href="/tags/#Hello World" title="Hello World"
        rel="1">#Hello World (1) </a>
    
    <a class="post-tag-item" href="/tags/#八皇后" title="八皇后"
        rel="1">#八皇后 (1) </a>
    
    <a class="post-tag-item" href="/tags/#算法" title="算法"
        rel="2">#算法 (2) </a>
    
    <a class="post-tag-item" href="/tags/#创建型模式" title="创建型模式"
        rel="1">#创建型模式 (1) </a>
    
    <a class="post-tag-item" href="/tags/#设计模式" title="设计模式"
        rel="3">#设计模式 (3) </a>
    
    <a class="post-tag-item" href="/tags/#分布式" title="分布式"
        rel="3">#分布式 (3) </a>
    
    <a class="post-tag-item" href="/tags/#CAP" title="CAP"
        rel="1">#CAP (1) </a>
    
    <a class="post-tag-item" href="/tags/#概念" title="概念"
        rel="4">#概念 (4) </a>
    
    <a class="post-tag-item" href="/tags/#脑裂" title="脑裂"
        rel="1">#脑裂 (1) </a>
    
    <a class="post-tag-item" href="/tags/#术语" title="术语"
        rel="1">#术语 (1) </a>
    
    <a class="post-tag-item" href="/tags/#理论" title="理论"
        rel="1">#理论 (1) </a>
    
    <a class="post-tag-item" href="/tags/#Docker" title="Docker"
        rel="2">#Docker (2) </a>
    
    <a class="post-tag-item" href="/tags/#入门" title="入门"
        rel="2">#入门 (2) </a>
    
    <a class="post-tag-item" href="/tags/#学习笔记" title="学习笔记"
        rel="1">#学习笔记 (1) </a>
    
    <a class="post-tag-item" href="/tags/#JavaScript" title="JavaScript"
        rel="4">#JavaScript (4) </a>
    
    <a class="post-tag-item" href="/tags/#chameleon" title="chameleon"
        rel="2">#chameleon (2) </a>
    
    <a class="post-tag-item" href="/tags/#跨平台" title="跨平台"
        rel="2">#跨平台 (2) </a>
    
    <a class="post-tag-item" href="/tags/#小程序" title="小程序"
        rel="2">#小程序 (2) </a>
    
    <a class="post-tag-item" href="/tags/#Android" title="Android"
        rel="1">#Android (1) </a>
    
    <a class="post-tag-item" href="/tags/#apk" title="apk"
        rel="1">#apk (1) </a>
    
    <a class="post-tag-item" href="/tags/#反编译" title="反编译"
        rel="1">#反编译 (1) </a>
    
    <a class="post-tag-item" href="/tags/#Java" title="Java"
        rel="49">#Java (49) </a>
    
    <a class="post-tag-item" href="/tags/#面试" title="面试"
        rel="3">#面试 (3) </a>
    
    <a class="post-tag-item" href="/tags/#数据结构" title="数据结构"
        rel="1">#数据结构 (1) </a>
    
    <a class="post-tag-item" href="/tags/#IO" title="IO"
        rel="12">#IO (12) </a>
    
    <a class="post-tag-item" href="/tags/#同步" title="同步"
        rel="1">#同步 (1) </a>
    
    <a class="post-tag-item" href="/tags/#异步" title="异步"
        rel="1">#异步 (1) </a>
    
    <a class="post-tag-item" href="/tags/#阻塞" title="阻塞"
        rel="1">#阻塞 (1) </a>
    
    <a class="post-tag-item" href="/tags/#非阻塞" title="非阻塞"
        rel="1">#非阻塞 (1) </a>
    
    <a class="post-tag-item" href="/tags/#符号链接" title="符号链接"
        rel="1">#符号链接 (1) </a>
    
    <a class="post-tag-item" href="/tags/#目录" title="目录"
        rel="1">#目录 (1) </a>
    
    <a class="post-tag-item" href="/tags/#deb" title="deb"
        rel="2">#deb (2) </a>
    
    <a class="post-tag-item" href="/tags/#chrome" title="chrome"
        rel="1">#chrome (1) </a>
    
    <a class="post-tag-item" href="/tags/#快捷键" title="快捷键"
        rel="1">#快捷键 (1) </a>
    
    <a class="post-tag-item" href="/tags/#bbr" title="bbr"
        rel="1">#bbr (1) </a>
    
    <a class="post-tag-item" href="/tags/#协议" title="协议"
        rel="3">#协议 (3) </a>
    
    <a class="post-tag-item" href="/tags/#XXNET" title="XXNET"
        rel="1">#XXNET (1) </a>
    
    <a class="post-tag-item" href="/tags/#磁盘管理" title="磁盘管理"
        rel="1">#磁盘管理 (1) </a>
    
    <a class="post-tag-item" href="/tags/#挂载" title="挂载"
        rel="1">#挂载 (1) </a>
    
    <a class="post-tag-item" href="/tags/#网络" title="网络"
        rel="2">#网络 (2) </a>
    
    <a class="post-tag-item" href="/tags/#模型" title="模型"
        rel="2">#模型 (2) </a>
    
    <a class="post-tag-item" href="/tags/#MMAP" title="MMAP"
        rel="1">#MMAP (1) </a>
    
    <a class="post-tag-item" href="/tags/#内存映射" title="内存映射"
        rel="1">#内存映射 (1) </a>
    
    <a class="post-tag-item" href="/tags/#内存" title="内存"
        rel="1">#内存 (1) </a>
    
    <a class="post-tag-item" href="/tags/#零拷贝" title="零拷贝"
        rel="2">#零拷贝 (2) </a>
    
    <a class="post-tag-item" href="/tags/#输入法" title="输入法"
        rel="1">#输入法 (1) </a>
    
    <a class="post-tag-item" href="/tags/#命令" title="命令"
        rel="1">#命令 (1) </a>
    
    <a class="post-tag-item" href="/tags/#集合运算" title="集合运算"
        rel="1">#集合运算 (1) </a>
    
    <a class="post-tag-item" href="/tags/#Ubuntu" title="Ubuntu"
        rel="1">#Ubuntu (1) </a>
    
    <a class="post-tag-item" href="/tags/#包管理" title="包管理"
        rel="4">#包管理 (4) </a>
    
    <a class="post-tag-item" href="/tags/#TCP" title="TCP"
        rel="3">#TCP (3) </a>
    
    <a class="post-tag-item" href="/tags/#UDP" title="UDP"
        rel="2">#UDP (2) </a>
    
    <a class="post-tag-item" href="/tags/#网络协议" title="网络协议"
        rel="1">#网络协议 (1) </a>
    
    <a class="post-tag-item" href="/tags/#CDN" title="CDN"
        rel="1">#CDN (1) </a>
    
    <a class="post-tag-item" href="/tags/#Socket" title="Socket"
        rel="1">#Socket (1) </a>
    
    <a class="post-tag-item" href="/tags/#vpn" title="vpn"
        rel="1">#vpn (1) </a>
    
    <a class="post-tag-item" href="/tags/#ssh" title="ssh"
        rel="1">#ssh (1) </a>
    
    <a class="post-tag-item" href="/tags/#Heidi" title="Heidi"
        rel="1">#Heidi (1) </a>
    
    <a class="post-tag-item" href="/tags/#MySQL" title="MySQL"
        rel="9">#MySQL (9) </a>
    
    <a class="post-tag-item" href="/tags/#网络术语" title="网络术语"
        rel="3">#网络术语 (3) </a>
    
    <a class="post-tag-item" href="/tags/#URL" title="URL"
        rel="1">#URL (1) </a>
    
    <a class="post-tag-item" href="/tags/#URI" title="URI"
        rel="1">#URI (1) </a>
    
    <a class="post-tag-item" href="/tags/#Tampermonkey" title="Tampermonkey"
        rel="1">#Tampermonkey (1) </a>
    
    <a class="post-tag-item" href="/tags/#弹琴吧" title="弹琴吧"
        rel="1">#弹琴吧 (1) </a>
    
    <a class="post-tag-item" href="/tags/#吉他" title="吉他"
        rel="1">#吉他 (1) </a>
    
    <a class="post-tag-item" href="/tags/#V2ray" title="V2ray"
        rel="1">#V2ray (1) </a>
    
    <a class="post-tag-item" href="/tags/#Jira" title="Jira"
        rel="1">#Jira (1) </a>
    
    <a class="post-tag-item" href="/tags/#管理" title="管理"
        rel="2">#管理 (2) </a>
    
    <a class="post-tag-item" href="/tags/#认知" title="认知"
        rel="1">#认知 (1) </a>
    
    <a class="post-tag-item" href="/tags/#备份" title="备份"
        rel="1">#备份 (1) </a>
    
    <a class="post-tag-item" href="/tags/#MSSQL" title="MSSQL"
        rel="1">#MSSQL (1) </a>
    
    <a class="post-tag-item" href="/tags/#Redis" title="Redis"
        rel="1">#Redis (1) </a>
    
    <a class="post-tag-item" href="/tags/#优化" title="优化"
        rel="2">#优化 (2) </a>
    
    <a class="post-tag-item" href="/tags/#SQL优化" title="SQL优化"
        rel="2">#SQL优化 (2) </a>
    
    <a class="post-tag-item" href="/tags/#ACID" title="ACID"
        rel="1">#ACID (1) </a>
    
    <a class="post-tag-item" href="/tags/#幻读" title="幻读"
        rel="1">#幻读 (1) </a>
    
    <a class="post-tag-item" href="/tags/#性能优化" title="性能优化"
        rel="4">#性能优化 (4) </a>
    
    <a class="post-tag-item" href="/tags/#阅读笔记" title="阅读笔记"
        rel="2">#阅读笔记 (2) </a>
    
    <a class="post-tag-item" href="/tags/#字符集" title="字符集"
        rel="2">#字符集 (2) </a>
    
    <a class="post-tag-item" href="/tags/#Collation" title="Collation"
        rel="1">#Collation (1) </a>
    
    <a class="post-tag-item" href="/tags/#临时表" title="临时表"
        rel="1">#临时表 (1) </a>
    
    <a class="post-tag-item" href="/tags/#Vue" title="Vue"
        rel="2">#Vue (2) </a>
    
    <a class="post-tag-item" href="/tags/#二进制" title="二进制"
        rel="2">#二进制 (2) </a>
    
    <a class="post-tag-item" href="/tags/#内存分配" title="内存分配"
        rel="1">#内存分配 (1) </a>
    
    <a class="post-tag-item" href="/tags/#内存泄露" title="内存泄露"
        rel="1">#内存泄露 (1) </a>
    
    <a class="post-tag-item" href="/tags/#书籍推荐" title="书籍推荐"
        rel="1">#书籍推荐 (1) </a>
    
    <a class="post-tag-item" href="/tags/#知识体系" title="知识体系"
        rel="1">#知识体系 (1) </a>
    
    <a class="post-tag-item" href="/tags/#反码" title="反码"
        rel="1">#反码 (1) </a>
    
    <a class="post-tag-item" href="/tags/#补码" title="补码"
        rel="1">#补码 (1) </a>
    
    <a class="post-tag-item" href="/tags/#单例" title="单例"
        rel="1">#单例 (1) </a>
    
    <a class="post-tag-item" href="/tags/#DCL" title="DCL"
        rel="1">#DCL (1) </a>
    
    <a class="post-tag-item" href="/tags/#内存模型" title="内存模型"
        rel="1">#内存模型 (1) </a>
    
    <a class="post-tag-item" href="/tags/#jvm" title="jvm"
        rel="3">#jvm (3) </a>
    
    <a class="post-tag-item" href="/tags/#HashMap" title="HashMap"
        rel="1">#HashMap (1) </a>
    
    <a class="post-tag-item" href="/tags/#Java集合" title="Java集合"
        rel="1">#Java集合 (1) </a>
    
    <a class="post-tag-item" href="/tags/#ThreadLocal" title="ThreadLocal"
        rel="1">#ThreadLocal (1) </a>
    
    <a class="post-tag-item" href="/tags/#Java线程" title="Java线程"
        rel="3">#Java线程 (3) </a>
    
    <a class="post-tag-item" href="/tags/#异常" title="异常"
        rel="1">#异常 (1) </a>
    
    <a class="post-tag-item" href="/tags/#Java异常" title="Java异常"
        rel="1">#Java异常 (1) </a>
    
    <a class="post-tag-item" href="/tags/#思维导图" title="思维导图"
        rel="2">#思维导图 (2) </a>
    
    <a class="post-tag-item" href="/tags/#垃圾回收" title="垃圾回收"
        rel="2">#垃圾回收 (2) </a>
    
    <a class="post-tag-item" href="/tags/#Java引用" title="Java引用"
        rel="1">#Java引用 (1) </a>
    
    <a class="post-tag-item" href="/tags/#Exception" title="Exception"
        rel="1">#Exception (1) </a>
    
    <a class="post-tag-item" href="/tags/#Stream" title="Stream"
        rel="1">#Stream (1) </a>
    
    <a class="post-tag-item" href="/tags/#Netty" title="Netty"
        rel="4">#Netty (4) </a>
    
    <a class="post-tag-item" href="/tags/#笔记" title="笔记"
        rel="1">#笔记 (1) </a>
    
    <a class="post-tag-item" href="/tags/#NIO" title="NIO"
        rel="7">#NIO (7) </a>
    
    <a class="post-tag-item" href="/tags/#Buffer" title="Buffer"
        rel="1">#Buffer (1) </a>
    
    <a class="post-tag-item" href="/tags/#Selector" title="Selector"
        rel="1">#Selector (1) </a>
    
    <a class="post-tag-item" href="/tags/#问题" title="问题"
        rel="2">#问题 (2) </a>
    
    <a class="post-tag-item" href="/tags/#直接内存" title="直接内存"
        rel="1">#直接内存 (1) </a>
    
    <a class="post-tag-item" href="/tags/#非直接内存" title="非直接内存"
        rel="1">#非直接内存 (1) </a>
    
    <a class="post-tag-item" href="/tags/#堆内存" title="堆内存"
        rel="1">#堆内存 (1) </a>
    
    <a class="post-tag-item" href="/tags/#注解" title="注解"
        rel="1">#注解 (1) </a>
    
    <a class="post-tag-item" href="/tags/#Spring" title="Spring"
        rel="6">#Spring (6) </a>
    
    <a class="post-tag-item" href="/tags/#文件加载" title="文件加载"
        rel="1">#文件加载 (1) </a>
    
    <a class="post-tag-item" href="/tags/#Spring Boot" title="Spring Boot"
        rel="3">#Spring Boot (3) </a>
    
    <a class="post-tag-item" href="/tags/#Spring Cloud" title="Spring Cloud"
        rel="1">#Spring Cloud (1) </a>
    
    <a class="post-tag-item" href="/tags/#Gradle" title="Gradle"
        rel="3">#Gradle (3) </a>
    
    <a class="post-tag-item" href="/tags/#Idea" title="Idea"
        rel="1">#Idea (1) </a>
    
    <a class="post-tag-item" href="/tags/#JavaIDE" title="JavaIDE"
        rel="1">#JavaIDE (1) </a>
    
    <a class="post-tag-item" href="/tags/#监控" title="监控"
        rel="1">#监控 (1) </a>
    
    <a class="post-tag-item" href="/tags/#报警" title="报警"
        rel="1">#报警 (1) </a>
    
    <a class="post-tag-item" href="/tags/#Prometheus" title="Prometheus"
        rel="1">#Prometheus (1) </a>
    
    <a class="post-tag-item" href="/tags/#SVN" title="SVN"
        rel="1">#SVN (1) </a>
    
    <a class="post-tag-item" href="/tags/#结构型模式" title="结构型模式"
        rel="1">#结构型模式 (1) </a>
    
    <a class="post-tag-item" href="/tags/#行为型模式" title="行为型模式"
        rel="1">#行为型模式 (1) </a>
    
    <a class="post-tag-item" href="/tags/#云原生" title="云原生"
        rel="1">#云原生 (1) </a>
    
    <a class="post-tag-item" href="/tags/#Cloud" title="Cloud"
        rel="1">#Cloud (1) </a>
    
    <a class="post-tag-item" href="/tags/#异步IO" title="异步IO"
        rel="1">#异步IO (1) </a>
    
    <a class="post-tag-item" href="/tags/#直接IO" title="直接IO"
        rel="1">#直接IO (1) </a>
    
    <a class="post-tag-item" href="/tags/#慢查" title="慢查"
        rel="1">#慢查 (1) </a>
    
    <a class="post-tag-item" href="/tags/#序列化" title="序列化"
        rel="1">#序列化 (1) </a>
    
    <a class="post-tag-item" href="/tags/#函数式编程" title="函数式编程"
        rel="1">#函数式编程 (1) </a>
    
    <a class="post-tag-item" href="/tags/#lambda" title="lambda"
        rel="1">#lambda (1) </a>
    
    <a class="post-tag-item" href="/tags/#并发编程" title="并发编程"
        rel="1">#并发编程 (1) </a>
    
    <a class="post-tag-item" href="/tags/#JUC" title="JUC"
        rel="1">#JUC (1) </a>
    
    <a class="post-tag-item" href="/tags/#lambda表达式" title="lambda表达式"
        rel="1">#lambda表达式 (1) </a>
    
    <a class="post-tag-item" href="/tags/#源码" title="源码"
        rel="1">#源码 (1) </a>
    
    <a class="post-tag-item" href="/tags/#RPC" title="RPC"
        rel="1">#RPC (1) </a>
    
    <a class="post-tag-item" href="/tags/#Reactor" title="Reactor"
        rel="1">#Reactor (1) </a>
    
    <a class="post-tag-item" href="/tags/#NIO模型" title="NIO模型"
        rel="1">#NIO模型 (1) </a>
    
    <a class="post-tag-item" href="/tags/#工具" title="工具"
        rel="1">#工具 (1) </a>
    
    <a class="post-tag-item" href="/tags/#Wiki" title="Wiki"
        rel="1">#Wiki (1) </a>
    
    <a class="post-tag-item" href="/tags/#整理" title="整理"
        rel="1">#整理 (1) </a>
    
    <a class="post-tag-item" href="/tags/#操作系统" title="操作系统"
        rel="1">#操作系统 (1) </a>
    
    <a class="post-tag-item" href="/tags/#Spring Core" title="Spring Core"
        rel="1">#Spring Core (1) </a>
    
    <a class="post-tag-item" href="/tags/#源码分析" title="源码分析"
        rel="1">#源码分析 (1) </a>
    
    <a class="post-tag-item" href="/tags/#文件名批量修改" title="文件名批量修改"
        rel="1">#文件名批量修改 (1) </a>
    
</div>
    </div>
    <!-- 评论 -->
    
    <div class="col-xs-12">
        
    </div>
    
</div>
<aside class="float-left gkt-sidebar hidden-xs hidden-sm">
    <div style="clear: both"></div>
    <div class="gkt-sidebar-wrapper">
        <section class="box-shadow"><style>
    .gkt-summary {
        border: 1px solid #DDDDDD;
        border-radius: 3px;
        padding: 5px;
        width: 100%;
    }


    .gkt-summary nav {
        overflow: hidden;
    }

    .gkt-summary nav a {
        display: inline-block;
        text-align: center;
        color: #333;
        font-size: 12px;
    }

    .gkt-summary nav span {
        display: block;
    }

    .gkt-summary nav .middle {
        border-left: 1px solid #eaecef;
        border-right: 1px solid #eaecef;
    }

    .gkt-summary .number {
        font-weight: bold;
    }

    .gkt-summary .link-list {
        margin-top: 5px;
        margin-bottom: -5px;
        padding-top: 7px;
        border-top: 1px dashed #999;
        display: flex;
    }

    .gkt-summary .link-list a {
        flex: 1;
    }

    .gkt-summary .link-list img {
        width: 25px;
        height: 25px;
    }
</style>

<div class="gkt-summary">
    <nav>
        <a href="/" class="col-xs-4">
            <span class="number">115</span><span>文章</span>
        </a>
        <a href="/series" class="col-xs-4 middle">
            <span class="number">35</span><span>专题</span>
        </a>
        <a href="/tags" class="col-xs-4">
            <span class="number">150</span><span>标签</span>
        </a>
    </nav>

    
</div></section>
        
        
        <section class="gkt-sidebar-content box-shadow">
            <strong>Java 基础</strong>
            <ul>
                
                <li>
                    <a href="/post/java/basic/2016-10-25_hashmap_jdk7.html"
                        class="">关于 HashMap （JDK 1.7）</a>
                    
                </li>
                
                <li>
                    <a href="/post/java/basic/2016-10-25_threadlocal.html"
                        class="">ThreadLocal 笔记</a>
                    
                </li>
                
                <li>
                    <a href="/post/java/basic/2016-11-18_try_with_resources.html"
                        class="">Java7 里 try-with-resources 分析</a>
                    
                </li>
                
                <li>
                    <a href="/post/java/basic/2017-04-18_java_thread_mind.html"
                        class="">Java Thread 线程知识整理（思维导图）</a>
                    
                </li>
                
                <li>
                    <a href="/post/java/basic/2017-07-14_java_reference.html"
                        class="">Java 引用</a>
                    
                </li>
                
                <li>
                    <a href="/post/java/basic/2017-11-10_java-lambda.html"
                        class="">Java8 lambda表达式10个示例</a>
                    
                </li>
                
                <li>
                    <a href="/post/java/basic/2019-01-21_java_thread_source.html"
                        class="gkt-sidebar-active">从源码的角度再学「Thread」</a>
                    
                    <!-- Table of Contents -->
<div id="sidebar-toc">
  <!-- TOC  -->
  
  
  <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-nav-text">前言</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E4%BB%8E%E6%B3%A8%E9%87%8A%E5%BC%80%E5%A7%8B"><span class="toc-nav-text">从注释开始</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Thread-%E5%B8%B8%E7%94%A8%E5%B1%9E%E6%80%A7"><span class="toc-nav-text">Thread 常用属性</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Thread-%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95"><span class="toc-nav-text">Thread 构造方法</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-nav-text">常用方法</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-nav-text">总结</span></a></li></ol>
  
</div>

<script>
  (function () {
    var h2 = document.querySelectorAll('article h2');
    var h3 = document.querySelectorAll('article h3');
    var linkList = document.querySelectorAll('#sidebar-toc a');

    function findLinkElement(name) {
      for (var i = 0; i < linkList.length; i++) {
        var items = linkList[i].href.split('#');
        if (items && items[items.length - 1] === encodeURIComponent(name)) {
          return i;
        }
      }
      return -1;
    }

    function activeLink(titleList) {
      var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
      for (var i = titleList.length - 1; i >= 0; i--) {
        if (scrollTop - titleList[i].offsetTop > 0) {
          var index = findLinkElement(titleList[i].id);
          index != -1 && linkList[index].classList.add('gkt-sidebar-active');
          break;
        }
      }
    }

    window.addEventListener("scroll", function (e) {
      [].slice.call(linkList).forEach(function (link) {
        link.classList.remove('gkt-sidebar-active');
      })
      activeLink(h2);
    })
  })();
</script>
                    
                </li>
                
            </ul>
        </section>
        
        
        <section class="gkt-sidebar-content box-shadow">
            <strong>最近的文章</strong>
            <ul>
                
                <li>
                    <a href="/post/util/2020-12-20_批量去除文件名部分关键字.html">使用JS脚本批量去除文件名中部分关键字</a>
                </li>
                
                <li>
                    <a href="/post/linux/2020-12-16_原来8张图，就可以搞懂「零拷贝」了.html">原来 8 张图，就可以搞懂「零拷贝」了</a>
                </li>
                
                <li>
                    <a href="/post/dateabase/Redis/2020_12_08_Redis清理方法.html">Redis存储优化</a>
                </li>
                
            </ul>
        </section>
        
    </div>
</aside>

<script>
    (function () {
        function resizeUArrow() {
            var s = getDom('.u-arrow-wrapper').style
            var pc = getDom('.post-container')
            s.left = getPosition(pc).x + 'px';
            s.width = pc.clientWidth + 'px';
        }
        resizeUArrow()
        window.addEventListener('resize', resizeUArrow);
    })();
</script>

    

<script>
    (function () {
        var ele = getDom('.gkt-sidebar-content')
        if(!ele) return;
        var wrapper = getDom('.gkt-sidebar-wrapper')
        var last = 0
        ele.style.maxHeight = ((window.innerHeight || 798) - 200) + 'px'
        var f = function (e) {
            var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
            var isDown = scrollTop > last;
            var pos = getPosition(ele).y - scrollTop;
            var downLimit = 50;
            var upLimit = -100;
            // uarrow.style.marginTop = scrollTop + 'px';
            isDown && pos <= downLimit && wrapper.classList.add("gkt-sidebar-fixed");
            !isDown && pos > upLimit && wrapper.classList.remove("gkt-sidebar-fixed");
            last = scrollTop
        }
        f()
        window.addEventListener("scroll", f)
    })();
</script>

</main>
    </div>
    <style>
    img#go-top {
        position: fixed;
        bottom: 100px;
        width: 50px;
        cursor: pointer;
        z-index: 9999;
    }
</style>
<img id="go-top" src="/icon/top.png" class="hidden-xs" style="display: none" />
<script>
    (function () {
        var goTop = document.getElementById('go-top');
        var mainContainer = document.querySelector('.main-container');
        
        goTop.addEventListener('click', function () {
            window.scroll(0, 0);
        }, false);
        window.addEventListener('scroll', function () {
            var right = document.body.offsetWidth - mainContainer.getBoundingClientRect().right;
            var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
            goTop.style.right = right + 10 + 'px'
            scrollTop > 700 && (goTop.style.display = "block");
            scrollTop <= 700 && (goTop.style.display = "none");
        });
    })();
</script>
    <style>
    #geektutu-click-img-container {
        position: fixed;
        left: 0;
        top: 0;
        text-align: center;
        width: 100%;
        display: none;
        z-index: 9999;
    }

    #geektutu-click-img-container img {
        object-fit: contain;
        background: #eaecef;
        padding: 15px;
        border-radius: 10px;
        height: auto;
        width: auto;
        vertical-align: middle;
    }
</style>


<div id="geektutu-click-img-container">
    <img src="" alt="Big Image">
</div>

<script>
    (function () {
        var container = document.querySelector('#geektutu-click-img-container')
        var targetImg = container.querySelector('img')
        var imgs = document.querySelectorAll('article img');
        targetImg.addEventListener('click', function (e) {
            container.style.display = 'none';
            e && e.stopPropagation && e.stopPropagation();
        }, false);

        for (var i = 0; i < imgs.length; ++i) {
            var img = imgs[i];
            img.addEventListener('click', (function (src, rate) {
                return function (e) {
                    e && e.stopPropagation && e.stopPropagation();
                    if (window.innerWidth < 980) {
                        return
                    }
                    targetImg.style.height = targetImg.style.width = 'auto';
                    if (window.innerWidth / window.innerHeight > rate) {
                        targetImg.style.height = (window.innerHeight - 20) + 'px';
                    } else {
                        targetImg.style.width = (window.innerWidth - 20) + 'px';
                    }
                    container.style.height = window.innerHeight + 'px'
                    container.style.lineHeight = window.innerHeight + 'px'
                    container.style.display = 'block';
                    targetImg.src = src;
                };
            }(img.src, img.width / img.height)), false)
        }
    })();
</script>
    <!-- Footer -->
    <!-- Footer -->
<style>
    footer {
        width: 100%;
        line-height: 1.5;
        padding: 20px;
    }

    footer a {
        color: #333;
        text-decoration: none;
    }

    .footer-hexo img {
        height: 20px;
        margin-bottom: -5px;
    }

    .footer-hexo a {
        color: #337ab7;
    }
</style>
<footer class="text-center col-xs-12">
    <p>
        <small>© 2020 - Hassan - </small>
        <small>
            <a target="_blank" rel="nofollow noopener" href="http://beian.miit.gov.cn/"></a>
        </small>
    </p>
    <p class="footer-hexo">
        <!-- 但若直接使用或修改主题，请务必保留这段声明 -->
        <small>Powered by <a target="_blank" href="https://hexo.io">Hexo</a> | Theme
            <a target="_blank" href="https://geektutu.com">Geektutu</a>
            <a target="_blank" rel="noopener" href="https://github.com/geektutu/hexo-theme-geektutu">
                <img src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAYGBgYHBgcICAcKCwoLCg8ODAwODxYQERAREBYiFRkVFRkVIh4kHhweJB42KiYmKjY+NDI0PkxERExfWl98fKcBBgYGBgcGBwgIBwoLCgsKDw4MDA4PFhAREBEQFiIVGRUVGRUiHiQeHB4kHjYqJiYqNj40MjQ+TERETF9aX3x8p//CABEIACIAUAMBIgACEQEDEQH/xAAcAAABBAMBAAAAAAAAAAAAAAAAAQQFBwIDBgj/2gAIAQEAAAAA9KrHSgAYL5/z6zZGuJd12uugbhq3uKtmuRtix20IS7lTLAfAAAn/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oACAECEAAAAAAB/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAgBAxAAAAAAAf/EADEQAAICAQIEBQEGBwAAAAAAAAECAwQFAAYREhORBxQhUlQxQVFic5KxJDJCYYGC0f/aAAgBAQABPwCFHnjWUzuvN6hV4cANSRLGjO9yRVUcSzMoA7jVXJYe5N0a2dhmk9kc0bN2GvLN8mbuNeWb5M3ca8s3yZu415Y/Jm7jXlm+TN3H/NeVPyZu40vOk3TZywK8wJ+v3EHVM/wsI/Dq2lrxN3Nnca16eti8chSAIoMbzByhMwP14kHVfwIiSaF5c96J6kwwCOTnHsYk8uvCrdmQy1TI4rJuz3cZLyGR/wCd4+YoOf8AEpUjXitubLYPG4paFsUxcuiGe7yc5gTW3LW44szXmobsi3Dhmic2+Z4+vCVH9CpraPiQ+QvbgTJrPFBWd5YpWrmNIIEXiRO32Pqt4p7cnfHk18lFBdmEVW1LVdIZGOrniTt6plrWKaO69yCykDRxwF+LMAewB0Txtr+Sf31VI8tEPw62fZt7N3Humtbpzz13ucX6CGSWMSuzpLyD1eNgeUka3PuvHbaxq3biTMHfkiSNCS78CwU+3Xg7Vu3MhuTcU6cq3Zemn3Eh2dv8Lzcut+29x1atKbHYqLJUhLwyNMwiZ3j9yDWOxUOV3tgb+3No5LDx1pi9+aeIwRlNY6bc+Jv+IFGrhLxtXJZ7VKcw81diiAAEn0JOrkWZyNfbEr0tz27UGQgkuGzXdIIvyowq99bRxk9ffO/L81SZBPZgEEroQroIxxMZOgeNsfkn99QypHGqO4Vl9CDrN4LDZkwyzyyQ2IgRHZrzGCZVP1XnQglT9oOtw4LC7iqV6uRkZoYpxKFSQpzFRw4EjVRMfSrQ1qqwxQxKFjjTgFUD7BoWYR6iVe+mtxt9Zwf9teaj4AdccPu5tedX5A/VrzUR+sy/q1CwksF19VEfDj/cnQRW+qg66cfsXtrpx+xe2unH7F7a6cfsXtrpx+xe2unH7F7a6cfsXtoxx+xe2gAAOA1//8QAFBEBAAAAAAAAAAAAAAAAAAAAMP/aAAgBAgEBPwB//8QAFBEBAAAAAAAAAAAAAAAAAAAAMP/aAAgBAwEBPwB//9k="
                    alt="Github Star">
            </a>
        </small>
    </p>
    
    <p>
        <small>
            <span id="busuanzi_container_site_pv">👁<span id="busuanzi_value_site_pv"></span></span> &nbsp;
            <span id="busuanzi_container_page_pv">📚<span id="busuanzi_value_page_pv"></span></span>
        </small>
    </p>
    
    

</footer>


<script>
    window.addEventListener('load', function () {
        globalAddScript('//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js');
    })
</script>

<!-- Baidu Tongji -->





    <script>
        // 非本站网址，新开tab页签
        (function () {
            var stopBubble = function (e) {
                e && e.stopPropagation && e.stopPropagation();
            }
            var links = document.querySelectorAll('a');
            [].slice.call(links).forEach(function (item) {
                if (item.href && item.href.indexOf(window.location.host) === -1) {
                    item.target = '_blank'
                }
                // 阻止冒泡，不触发彩蛋。
                item.addEventListener('click', stopBubble, false);
            });
            var article = document.querySelector('article');
            article && article.addEventListener('click', stopBubble, false)
        })();
    </script>
    
<script>
    (function (window, document, undefined) {
        var hearts = [];
        var keywords = ["点个赞", "留个言", "赞赏一下", "分享之", "blog.fenxiangz.com"];
        function randomInt(max) {
            return Math.floor(Math.random() * Math.floor(max));
        }
        window.addEventListener('click', createWord)

        function createWord(e) {
            var d = document.createElement("span");
            d.style.position = 'fixed';
            d.style.zIndex = 9999;
            d.style.color = 'rgb(' + [randomInt(255), randomInt(255), randomInt(255)].join(',') + ')';
            d.innerHTML = keywords[randomInt(keywords.length)];
            d.onselectstart = function () { return false; }

            hearts.push({ el: d, x: e.clientX - 5, y: e.clientY - 5, alpha: 1, scale: 1 });
            document.body.appendChild(d);
        }
        (function gameloop() {
            for (var i = 0; i < hearts.length; i++) {
                heart = hearts[i];
                if (heart.alpha <= 0) {
                    document.body.removeChild(heart.el);
                    hearts.splice(i, 1);
                    continue;
                }
                heart.y -= heart.alpha < 0.5 ? 2 : 1;
                heart.scale += 0.002;
                heart.alpha -= 0.013;
                heart.el.style.transform = 'scale(' + heart.scale + ')';
                heart.el.style.left = heart.x + 'px';
                heart.el.style.top = heart.y + 'px';
            }
            setTimeout(gameloop, 10)
        })();
    })(window, document);
</script>

</body>

</html>